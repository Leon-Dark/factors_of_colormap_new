<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>集成测试 - Integration Test</title>
</head>
<body>
    <h1>测试现有JS文件集成</h1>
    <div id="status"></div>
    
    <!-- 引入D3和依赖库 -->
    <script src="../rainbows good or bad for/supplementary materials/experiment interface/jnd/lib/d3.min.js"></script>
    
    <!-- 引入现有的高斯分布相关模块 -->
    <script src="../rainbows good or bad for/supplementary materials/experiment interface/src/scalar.js"></script>
    <script src="../rainbows good or bad for/supplementary materials/experiment interface/lineup/gaussmix.js"></script>
    <script src="../rainbows good or bad for/supplementary materials/experiment interface/lineup/gaussmix_bivariate.js"></script>
    <script src="../rainbows good or bad for/supplementary materials/experiment interface/lineup/gauss_w_noise.js"></script>
    <script src="../rainbows good or bad for/supplementary materials/experiment interface/lineup/scalar_sample.js"></script>
    
    <script>
        const statusDiv = document.getElementById('status');
        
        function log(msg, isError = false) {
            const p = document.createElement('p');
            p.textContent = msg;
            p.style.color = isError ? 'red' : 'green';
            statusDiv.appendChild(p);
        }
        
        try {
            // 测试1: 检查类是否存在
            log('✓ 检查类定义...');
            if (typeof biGauss === 'undefined') {
                log('✗ biGauss 未定义', true);
            } else {
                log('✓ biGauss 已加载');
            }
            
            if (typeof ScalarField === 'undefined') {
                log('✗ ScalarField 未定义', true);
            } else {
                log('✓ ScalarField 已加载');
            }
            
            // 测试2: 创建一个biGauss实例
            log('✓ 测试创建 biGauss 实例...');
            const testGauss = new biGauss(100, 100, 20, 20, 0.3, 1.0);
            log(`✓ 创建成功: mX=${testGauss.mX}, mY=${testGauss.mY}`);
            
            // 测试3: 测试eval方法
            log('✓ 测试 eval 方法...');
            const value = testGauss.eval(100, 100);
            log(`✓ eval(100, 100) = ${value.toFixed(4)}`);
            
            // 测试4: 测试updateRho方法
            log('✓ 测试 updateRho 方法...');
            testGauss.updateRho(0.5);
            log(`✓ updateRho(0.5) 成功, rho = ${testGauss.rho}`);
            
            // 测试5: 测试copy方法
            log('✓ 测试 copy 方法...');
            const copyGauss = testGauss.copy();
            log(`✓ copy 成功: mX=${copyGauss.mX}, mY=${copyGauss.mY}`);
            
            log('=============================');
            log('✓✓✓ 所有测试通过！集成成功！', false);
            
        } catch(e) {
            log(`✗✗✗ 错误: ${e.message}`, true);
            console.error(e);
        }
    </script>
</body>
</html>
