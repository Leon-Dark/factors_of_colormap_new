<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gaussian Perturbation Experiment (4AFC)</title>
    <link rel="stylesheet" href="css/styles.css">
</head>

<body>
    <div class="container">
        <!-- Intro Screen -->
        <div id="intro-screen" class="screen active">
            <h1>Gaussian Perturbation Perception Experiment</h1>

            <div class="instructions">
                <h2>Instructions</h2>
                <p>Welcome to this perception experiment.</p>
                <p><strong>Task:</strong> In each trial, you will see 4 images displayed in a grid.</p>
                <ul>
                    <li><strong>3 images</strong> are identical "Original" patterns.</li>
                    <li><strong>1 image</strong> is slightly "Perturbed" (different).</li>
                </ul>
                <p>Your goal is to identify and click on the <strong>Odd One Out</strong> (the perturbed image) as
                    quickly and accurately as possible.</p>
                <!-- <p>There will be 60 trials in total.</p> -->
            </div>

            <div class="form-group">
                <label for="participant-id">Participant ID:</label>
                <input type="text" id="participant-id" placeholder="Enter ID (e.g., P001)">
            </div>

            <button id="btn-start" class="btn-primary">Start Experiment</button>
        </div>

        <!-- Experiment Screen -->
        <div id="experiment-screen" class="screen">
            <div class="top-bar">
                <div class="trial-info">Trial: <span id="trial-current">0</span> / <span id="trial-total">0</span></div>
                <div class="progress-container">
                    <div id="progress-bar" class="progress-bar"></div>
                </div>
            </div>

            <div id="stimuli-container" class="stimuli-grid">
                <div class="stimulus-item" data-index="0"><canvas width="200" height="200"></canvas></div>
                <div class="stimulus-item" data-index="1"><canvas width="200" height="200"></canvas></div>
                <div class="stimulus-item" data-index="2"><canvas width="200" height="200"></canvas></div>
                <div class="stimulus-item" data-index="3"><canvas width="200" height="200"></canvas></div>
            </div>

            <div id="wait-message" class="wait-message" style="display:none;">Loading next trial...</div>
        </div>

        <!-- End Screen -->
        <div id="end-screen" class="screen">
            <h1>Experiment Complete</h1>
            <p>Thank you for your participation!</p>
            <p>Please download your data file below.</p>

            <div class="stats-summary">
                <p>Total Trials: <span id="result-total">0</span></p>
                <p>Accuracy: <span id="result-accuracy">0%</span></p>
            </div>

            <button id="btn-download" class="btn-primary">Download Data (CSV)</button>
        </div>
    </div>

    <!-- External Dependencies (From sibling directory) -->
    <!-- Note: Paths are relative to index.html location in random/perturbation_experiment/ -->
    <script
        src="../../../rainbows good or bad for/supplementary materials/experiment interface/jnd/lib/d3.min.js"></script>
    <script src="../../../rainbows good or bad for/supplementary materials/experiment interface/src/scalar.js"></script>
    <script
        src="../../../rainbows good or bad for/supplementary materials/experiment interface/lineup/gaussmix.js"></script>
    <script
        src="../../../rainbows good or bad for/supplementary materials/experiment interface/lineup/gaussmix_bivariate.js"></script>
    <script
        src="../../../rainbows good or bad for/supplementary materials/experiment interface/lineup/gauss_w_noise.js"></script>
    <script
        src="../../../rainbows good or bad for/supplementary materials/experiment interface/lineup/scalar_sample.js"></script>

    <!-- Project Logic Modules -->
    <script src="../gaussian_perturbation_system/js/utils.js"></script>
    <script src="../gaussian_perturbation_system/js/gaussianGenerator.js"></script>
    <script src="../gaussian_perturbation_system/js/perturbation.js"></script>
    <script src="../gaussian_perturbation_system/js/softAttributionPerturbation.js"></script>

    <!-- Experiment Logic -->
    <script src="js/experiment.js"></script>
</body>

</html>